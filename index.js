import{g,r as e,t as f,i as a,c as m,d as k,b as c,a as E,e as P,f as B,h as I}from"./assets/refs-OEryJ1Tz.js";import{i}from"./assets/vendor-D_elxl8o.js";function _(){const t=g("cart"),o=g("wishlist");console.log("Update counters:",t.length,o.length),e.countCart.textContent=t.length,e.countWishlist.textContent=o.length}function F(){e.loader.classList.remove("hidden")}function R(){e.loader.classList.add("hidden")}const u=document.querySelector(".scroll-up");window.addEventListener("scroll",()=>{window.scrollY>300?u.hidden=!1:u.hidden=!0});u.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});function T(t){const{id:o,thumbnail:s,title:r,description:n,price:p,category:w,brand:C}=t,b=a("wishlist",o),S=a("cart",o),h=e.modalContent.querySelector(".modal-product");if(!h)return console.error("modal-product not found");h.innerHTML=`
    <img class="modal-product__img" src="${s}" alt="${r}" />
    <div class="modal-product__content">
      <p class="modal-product__title">${r}</p>
      <ul class="modal-product__tags">
        <li>Brand: ${C}</li>
        <li>Category: ${w}</li>
      </ul>
      <p class="modal-product__description">${n}</p>
      <p class="modal-product__shipping-information">Shipping: Free</p>
      <p class="modal-product__return-policy">Return Policy: 30 days</p>
      <p class="modal-product__price">Price: $${p}</p>
    </div>
  `;const d=e.modalContent.querySelector(".modal-product__btn--wishlist"),l=e.modalContent.querySelector(".modal-product__btn--cart");d&&(d.textContent=b?"Remove from Wishlist":"Add to Wishlist",d.dataset.id=o),l&&(l.textContent=S?"Remove from Cart":"Add to Cart",l.dataset.id=o)}function q(){e.modal.classList.add("modal--is-open"),window.addEventListener("keydown",v)}function L(){e.modal.classList.remove("modal--is-open");const t=e.modalContent.querySelector(".modal-product");t&&(t.innerHTML=""),window.removeEventListener("keydown",v)}function v(t){t.key==="Escape"&&L()}e.modal.addEventListener("click",t=>{(t.target===e.modal||t.target.closest(".modal__close-btn"))&&L()});e.modalContent.addEventListener("click",t=>{const o=t.target.closest(".modal-product__btn--wishlist"),s=t.target.closest(".modal-product__btn--cart");if(o){const r=+o.dataset.id;console.log("Wishlist toggle",r),f("wishlist",r),o.textContent=a("wishlist",r)?"Remove from Wishlist":"Add to Wishlist",_()}if(s){const r=+s.dataset.id;console.log("Cart toggle",r),f("cart",r),s.textContent=a("cart",r)?"Remove from Cart":"Add to Cart",_()}});async function M(t){const o=t.target.closest(".categories__btn");if(!o)return;const s=o.textContent.trim();e.categoriesList.querySelectorAll(".categories__btn").forEach(n=>n.classList.remove("categories__btn--active")),o.classList.add("categories__btn--active"),e.productsList.innerHTML="",e.notFound.classList.remove("not-found--visible");try{let n=[];s==="All"?n=await m({limit:12,skip:0}):n=await k(s),n.length===0?e.notFound.classList.add("not-found--visible"):c(n)}catch{i.error({message:"Error loading products. Try again later",position:"topRight"})}}async function $(t){const o=t.target.closest("li.products__item");if(!o)return;const s=o.dataset.id;if(s)try{const r=await E(s);T(r),q()}catch{i.error({message:"Unable to load product",position:"topRight"})}}async function x(t){t.preventDefault();const o=e.searchInput.value.trim();if(e.productsList.innerHTML="",e.notFound.classList.remove("not-found--visible"),o!=="")try{const s=await P(o);s.length===0?e.notFound.classList.add("not-found--visible"):c(s.slice(0,12))}catch{i.error({message:"Product search error",position:"topRight"})}}async function A(){e.searchInput.value="",e.clearSearchBtn.hidden=!0,e.notFound.classList.remove("not-found--visible"),e.productsList.innerHTML="";try{const t=await m({limit:12,skip:0});c(t)}catch{i.error({message:"Failed to load products",position:"topRight"})}}function W(t){const o=t.target.value.trim();e.clearSearchBtn.hidden=o===""}let H=1;const y=12;B().then(t=>{I(["All",...t])}).catch(()=>{i.error({message:"Categories could not be loaded!"})});async function U(){F(),await new Promise(t=>setTimeout(t,0));try{const t=(H-1)*y,o=await m({limit:y,skip:t});c(o)}catch{i.error({message:"Products could not be loaded!"})}finally{R()}}U();e.categoriesList.addEventListener("click",M);e.productsList.addEventListener("click",$);e.searchForm.addEventListener("submit",x);e.searchInput.addEventListener("input",W);e.clearSearchBtn.addEventListener("click",A);
//# sourceMappingURL=index.js.map
